# 現物取引API

* [共通情報](#id1)
  * [事前準備](#id2)
  * [リクエスト方法](#id3)
  * [認証](#id4)
  * [パラメータ](#id5)
  * [戻り値](#id6)
  * [エラーメッセージ](#id7)
  * [補足](#id8)
* [個別情報](#id9)
  * [残高情報の取得](#id10)
  * [残高情報(軽量)の取得](#id14)
  * [チャット情報の取得](#id18)
  * [個人情報の取得](#id21)
  * [ユーザー自身の取引履歴を取得](#id24)
  * [未約定注文一覧の取得](#id28)
  * [注文](#id32)
  * [注文の取消し](#id37)
  * [出金](#id41)
  * [入金履歴の取得](#id45)
  * [出金履歴の取得](#id49)

------------------------------------------------------------------------------------------------------------------------

## 共通情報
現物取引APIの共通情報です。

------------------------------------------------------------------------------------------------------------------------

### 事前準備

* 取引APIを利用するには、[アカウント情報](https://zaif.jp/api_keys) のページからAPI Keyの発行をおこなってください。

### リクエスト方法

* エンドポイント：https://api.zaif.jp/tapi
* メソッド：POST

### 認証

* 取得したAPI Keysを利用して、下記のようにHTTPヘッダを設定し、認証情報を送信します。

```eval_rst
========== ========= ====================================
パラメータ 詳細      例
========== ========= ====================================
key        APIキー   490f983a-5fab-49b2-b789-9d1f130874d3
sign       署名      詳細は下記
========== ========= ====================================
```

``` note::
	signはPOSTする全てのパラメータ（nonceとmethodおよびメソッド毎のパラメータ）を URLエンコードしたクエリ形式(param1=val1&param2=val2)のメッセージとして、Secret Keyを用いてHMAC-SHA512で署名します。
```

### パラメータ

```eval_rst
========== ============= =========
パラメータ 詳細           例
========== ============= =========
nonce      1以上の数      23123
method     APIメソッド名 get_info
========== ============= =========
```

``` Note::
	メソッド毎の固有のパラメータも全てPOSTパラメータにて送信してください。
	nonceパラメータの値は実効毎に増分されていないとエラーが発生します。また、増分量は少数点以下の値にも対応しております。
```

### 戻り値

```eval_rst
======== =========== ===============
キー     詳細        型
======== =========== ===============
success  成功フラグ  int
return   実行結果    dict or string
======== =========== ===============
```

```
{
    "success": 1,
    "return": {
        ...
    }
}
```

### エラーメッセージ
```eval_rst
=============================================== ===================================================================
メッセージ                                      詳細
=============================================== ===================================================================
method not found                                指定されたメソッドが存在しません。
no data found for the key                       APIキーが無効です。
time wait restriction\, please try later.       同じメソッドが短時間に多く呼び出しされたときに発生します。
signature mismatch                              署名が不適切です。
invalid access token                            無効なトークンが指定されています。
expired access token                            トークンの有効期限が切れています。トークン再発行APIを参考にし、トークンの再発行をしてください。
nonce not incremented                           前回API実行時よりnonce値が加算されていません。
nonce out of range                              値が最大値を超えています。新しいAPIキーを発行してください。
api key don\’t have \{\} permission               API\ Keyに権限がありません。
invalid \{\} parameter                            指定されているパラメータが無効です。
=============================================== ===================================================================
```

### 補足

* 戻り値

	処理に成功した場合、successには1が、returnには実行結果が設定されます。

	処理に失敗した場合、successには0が、returnにはエラーメッセージが設定されます。

```eval_rst
.. _trading_notice_1:
```
* ※ 呼び出しの回数制限を解除するためには、当社の定めた条件(一定基準以上の取引高など)に基づく審査が必要になります。

------------------------------------------------------------------------------------------------------------------------

## 個別情報

現物取引APIの個別情報です。

------------------------------------------------------------------------------------------------------------------------

### 残高情報の取得

現在の残高（余力および残高・トークン）、APIキーの権限、過去のトレード数、アクティブな注文数、サーバーのタイムスタンプを取得します。

#### パラメータ
```eval_rst
========== ==== ======== ==== ==========
パラメータ 必須 詳細     型   デフォルト
========== ==== ======== ==== ==========
method     Yes  get_info str
========== ==== ======== ==== ==========
```

#### 戻り値
```eval_rst
=========== ============================ ====
キー        詳細                         型
=========== ============================ ====
funds       残高                         dict
deposit     残高に注文情報を加味した情報 dict
rights      キーが保持している権限       dict
trade_count 実行したトレード数           int
open_orders アクティブな注文数           int
server_time UNIX時間で換算された日本時間 int
=========== ============================ ====
```
```
{
    "success":1,
    "return":{
        "funds":{
            "jpy":15320,
            "btc":1.389,
            "xem":100.2,
            "mona":2600,
            "pepecash":0.1
        },
        "deposit":{
            "jpy":20440,
            "btc":1.479,
            "xem":100.2,
            "mona":3200,
            "pepecash":0.1
        },
        "rights":{
            "info":1,
            "trade":1,
            "withdraw":0,
            "personal_info":0,
            "id_info":0,
        },
        "trade_count":18,
        "open_orders":3,
        "server_time":1401950833
    }
}
```

#### 補足
* 呼び出しは10秒間に10回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)



* deposit算出方法

	depositは現在の資産の残高に注文情報を加味したものになります。

	買い注文が存在する場合、その注文の値段と量をかけ合わせたもので、売り注文が存在する場合は、その注文の量のみが加味されます。

* 取得できる情報は、APIを実行した時点のものになります。



------------------------------------------------------------------------------------------------------------------------

### 残高情報(軽量)の取得

get_infoの軽量版で、過去のトレード数を除く項目を返します。

#### パラメータ
```eval_rst
========== ==== ========= ===
パラメータ 必須 詳細      型
========== ==== ========= ===
method     Yes  get_info2 str
========== ==== ========= ===
```

#### 戻り値
```eval_rst
=========== ============================ ====
キー        詳細                         型
=========== ============================ ====
funds       残高                         dict
deposit     残高に注文情報を加味した情報 dict
rights      キーが保持している権限       dict
open_orders アクティブな注文数           int
server_time UNIX時間で換算された日本時間 int
=========== ============================ ====
```

```
{
    "success": 1,
    "return": {
        "funds": {
            "jpy": 15320,
            "btc": 1.389,
            "xem": 100.2,
            "mona": 2600,
            "pepecash": 0.1
        },
        "deposit": {
            "jpy": 20440,
            "btc": 1.479,
            "xem": 100.2,
            "mona": 3200,
            "pepecash": 0.1
        },
        "rights": {
            "info": 1,
            "trade": 1,
            "withdraw": 0,
            "personal_info": 0
        },
        "open_orders": 3,
        "server_time": 1401950833
    }
}
```

#### 補足
* 呼び出しは10秒間に20回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

* deposit算出方法

	depositは現在の資産の残高に注文情報を加味したものになります。

	買い注文が存在する場合、その注文の値段と量をかけ合わせたもので、売り注文が存在する場合は、その注文の量のみが加味されます。

* 取得できる情報は、APIを実行した時点のものになります。


------------------------------------------------------------------------------------------------------------------------

### チャット情報の取得

チャットに使用されるニックネームと画像のパスを返します。

#### パラメータ
```eval_rst
========== ==== ================== ===
パラメータ 必須 詳細               型
========== ==== ================== ===
method     Yes  get_personal_info  str
========== ==== ================== ===
```

#### 戻り値
```eval_rst
================ ============ =====
キー             詳細         型
================ ============ =====
ranking_nickname ニックネーム str
icon_path        画像のパス   str
================ ============ =====
```
```
{
    "success": 1,
    "return": {
        "ranking_nickname": "ニックネーム",
        "icon_path": "https://abs.twimg.com/sticky/default_profile_images/default_profile_0_normal.png"
    }
}
```

------------------------------------------------------------------------------------------------------------------------

### 個人情報の取得

ユーザーIDやメールアドレスといった個人情報を取得します。

#### パラメータ
```eval_rst
========== ==== =========== ====
パラメータ 必須 詳細        型
========== ==== =========== ====
method     Yes  get_id_info str
========== ==== =========== ====
```

#### 戻り値
```eval_rst
========= ================ ====
キー      詳細             型
========= ================ ====
id        ユーザーID       str
email     メールアドレス   str
name      ユーザ名         int
kana      ユーザ名カナ     str
certified 認証済みかどうか bool
========= ================ ====
```
```
{
    "success": 1,
    "return": {
    }
}
```

------------------------------------------------------------------------------------------------------------------------

### ユーザー自身の取引履歴を取得

ユーザー自身の取引履歴を取得します。

#### パラメータ
```eval_rst
=============== ==== ======================================== ================= ===========
パラメータ      必須 詳細                                     型                デフォルト
=============== ==== ======================================== ================= ===========
method          Yes  trade_history                            str
from            No   この順番のレコードから取得               int               0
count           No   取得するレコード数                       int               1000
from_id         No   このトランザクションIDのレコードから取得 int               0
end_id          No   このトランザクションIDのレコードまで取得 int               infinity
order           No   ソート順                                 str (ASC or DESC) DESC
since           No   開始タイムスタンプ                       UNIX_TIMESTAMP    0
end             No   終了タイムスタンプ                       UNIX_TIMESTAMP    infinity
currency_pair   No   通貨ペア                                 str               指定なし
is_token        No   カウンターパーティトークンかどうか       bool              false
=============== ==== ======================================== ================= ===========
```

#### 戻り値
```eval_rst
+-------------+------------------------------+--------------+
|キー         |詳細                          |型            |
+=============+==============================+==============+
|例）182      |注文ID                        |int           |
+-------------+------------------------------+--------------+
|currency_pair|通貨ペア                      |str           |
+-------------+------------------------------+--------------+
|action       |bid(買い) or ask(売り)        |str           |
+-------------+------------------------------+--------------+
|amount       |数量                          |float         |
+-------------+------------------------------+--------------+
|price        |価格                          |float         |
+-------------+------------------------------+--------------+
|fee          |手数料                        |float         |
+-------------+------------------------------+--------------+
|fee_amount   |手数料                        |float         |
+-------------+------------------------------+--------------+
|your_action  |bid(買い) or ask(売り)、      |str           |
|             |自己取引の場合はboth          |              |
+-------------+------------------------------+--------------+
|bonus        |マイナス手数料分              |float         |
+-------------+------------------------------+--------------+
|timestamp    |取引日時                      |UNIX_TIMESTAMP|
+-------------+------------------------------+--------------+
|comment      |注文のコメント                |str           |
+-------------+------------------------------+--------------+
```
```
{
    "success": 1,
    "return": {
        "182": {
            "currency_pair": "btc_jpy",
            "action": "bid",
            "amount": 0.03,
            "price": 56000,
            "fee": 0,
            "your_action": "ask",
            "bonus": 1.6,
            "timestamp": 1402018713,
            "comment" : "demo"
        }
    }
}
```


#### 補足
* 呼び出しは60秒間に12回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

* “since”もしくは”end”をセットした場合、”order”は強制的に”ASC”となります。

* “from_id”もしくは”end_id”をセットした場合、”order”は強制的に”ASC”となります。

* “currency_pair”と”is_token”の両方を指定した場合は”currency_pair”が優先されます。両方指定しない場合はカウンターパーティトークン以外の情報を取得します。


------------------------------------------------------------------------------------------------------------------------
```eval_rst
.. active_orders:
```
### 未約定注文一覧の取得

現在有効な注文一覧を取得します（未約定注文一覧）。

#### パラメータ
```eval_rst
+-------------+----+--------------------------------------------------------+----+----------+
|パラメータ   |必須|詳細                                                    |型  |デフォルト|
+=============+====+========================================================+====+==========+
|method       |Yes |active_orders                                           |str |          |
+-------------+----+--------------------------------------------------------+----+----------+
|currency_pair|No  |通貨ペア。指定なしで全通貨ペア                          |str |全通貨ペア|
+-------------+----+--------------------------------------------------------+----+----------+
|is_token     |No  |カウンターパーティトークンかどうか                      |bool|false     |
+-------------+----+--------------------------------------------------------+----+----------+
|is_token_both|No  |true：全てのアクティブなオーダー情報を取得              |bool|false     |
|             |    +--------------------------------------------------------+    |          |
|             |    |false：currency_pairやis_tokenに従ったオーダー情報を取得|    |          |
+-------------+----+--------------------------------------------------------+----+----------+
```

#### 戻り値
```eval_rst
============= ======================= =================
キー          詳細                    型
============= ======================= =================
例）184       注文ID                  int
currency_pair 通貨ペア                str
action        bid(買い) or ask(売り)  str
amount        数量                    int
price         価格                    int
timestamp     取引日時                UNIX_TIMESTAMP
comment       注文のコメント          str
============= ======================= =================
```
```
{
    "success": 1,
    "return": {
        "184": {
            "currency_pair": "btc_jpy",
            "action": "ask",
            "amount": 0.03,
            "price": 56000,
            "timestamp": 1402021125,
            "comment" : "demo"
        }
    }
}
```
is_token_bothがtrueの時は下記
```
{
   "success": 1,
   "return": {
       "active_orders": {
           "184": {
               "currency_pair": "btc_jpy",
               "action": "ask",
               "amount": 0.03,
               "price": 56000,
               "timestamp": 1402021125,
               "comment" : "demo"
           },
           "token_active_orders": {
               "235": {
                   "currency_pair": "kaori_jpy",
                   "action": "ask",
                   "amount": 0.3,
                   "price": 10,
                   "timestamp": 1402064525,
                   "comment" : "demo"
               }
           }
       }
   }
}
```

#### 補足
* 呼び出しは5秒間に10回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

------------------------------------------------------------------------------------------------------------------------
```eval_rst
.. _trade:
```
### 注文

取引注文を行います。

#### パラメータ
```eval_rst
============= ==== ====================== ===================== ===========
パラメータ    必須 詳細                   型                    デフォルト
============= ==== ====================== ===================== ===========
method        Yes  trade                  str
currency_pair Yes  通貨ペア               str(例)btc_jpy
action        Yes  bid(買い) or ask(売り) str
price         Yes  指値注文価格           numerical
amount        Yes  数量                   numerical
limit         No   リミット注文価格       numerical
comment       No   コメントの追加         str
============= ==== ====================== ===================== ===========
```

#### 戻り値
```eval_rst
+--------+-----------------------------------------------------------------+-------+
|キー    |詳細                                                             |型     |
+========+=================================================================+=======+
|received|今回の注文で約定した取引量                                       |float  |
+--------+-----------------------------------------------------------------+-------+
|remains |今回の注文で約定せず、板に残った取引量                           |float  |
+--------+-----------------------------------------------------------------+-------+
|order_id|今回の注文がすべて成立した場合は0、                              |int    |
|        +-----------------------------------------------------------------+       |
|        |一部、もしくはすべて約定しなかった場合は板に残った注文のID       |       |
+--------+-----------------------------------------------------------------+-------+
|funds   |残高                                                             |dict   |
+--------+-----------------------------------------------------------------+-------+
```
```
{
    "success": 1,
    "return": {
        "received": 0.1,
        "remains": 0,
        "order_id": 0,
        "funds": {
            "jpy": 325,
            "btc": 1.392,
            "mona": 2600
        }
    }
}
```

#### エラーメッセージ
```eval_rst
=============================================== ===================================================================
メッセージ                                      詳細
=============================================== ===================================================================
trade temporarily unavailable                   取引が一時的に停止されています。
your account is restricted now, KYC required.   本人確認が完了していないため、取引ができません。本人確認を完了させて下さい。
insuffcient funds                               取引に必要な残高が存在しません。
=============================================== ===================================================================
```

#### 補足
* 呼び出しは10秒間に9回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

* パラメータ limitについて

    リミット値（利確のための反対売買の指値）を指定することができます。
    リミット値を指定した場合、注文が成立した分だけの数量について、自動的にリミット注文が発行されます。

* パラメータ commentについて

    コメントは255字以内で半角英数字記号のみに対応しています。
    また、スラッシュは使えませんのでご注意ください。
    コメントをつけた取引注文が約定した場合、該当する取引履歴にそのコメントが付与されます。
    取引注文の管理にご利用ください。

* 価格および数量の数値について

    適切な価格（priceおよびlimit）、もしくは数量(amount)の単位以外で注文しようとした場合、invalid price parameterまたはinvalid amount parameterというエラーが返されます。
    適切な価格や数量は現物公開APIの[通貨ペア情報](PublicAPI.html#id12)で取得できます。
    通貨ペアごとに適切な価格や数量の最低量や単位は変わりますので、ご注意ください


------------------------------------------------------------------------------------------------------------------------

### 注文の取消し

注文の取消しを行います。

#### パラメータ
```eval_rst
+-------------+----+---------------------------------------------------------------------------------+--------------+-----------+
|パラメータ   |必須|詳細                                                                             |型            |デフォルト |
+=============+====+=================================================================================+==============+===========+
|method       |Yes |cancel_order                                                                     |str           |           |
+-------------+----+---------------------------------------------------------------------------------+--------------+-----------+
|order_id     |Yes |注文ID（ `注文`_ または `未約定注文一覧 <TradingAPI.html#id28>`_ で取得できます）|int           |           |
+-------------+----+---------------------------------------------------------------------------------+--------------+-----------+
|currency_pair|No  |通貨ペア                                                                         |str(例)btc_jpy|           |
+-------------+----+---------------------------------------------------------------------------------+--------------+-----------+
|is_token     |No  |true：カウンターパーティトークンのオーダーを取り消したい時                       |bool          |false      |
|             |    +---------------------------------------------------------------------------------+              |           |
|             |    |false：カウンターパーティトークン以外のオーダーを取り消したい時                  |              |           |
+-------------+----+---------------------------------------------------------------------------------+--------------+-----------+
```


``` Note::
  “currency_pair”と”is_token”の両方を指定した場合は”currency_pair”が優先されます。両方指定しない場合はカウンターパーティトークン以外の情報を操作します。
```

#### 戻り値
```eval_rst
======== ====== =====
キー     詳細   型
======== ====== =====
order_id 注文ID int
funds    残高   dict
======== ====== =====
```
```
{
    "success": 1,
    "return": {
        "order_id": 184,
        "funds": {
            "jpy": 15320,
            "btc": 1.392,
            "mona": 2600,
            "kaori": 0.1
        }
    }
}
```

#### エラーメッセージ
```eval_rst
=============================================== ===================================================================
メッセージ                                      詳細
=============================================== ===================================================================
order not found                                 注文が見つかりません。
order is too new                                注文から一定時間の経過が必要です。
=============================================== ===================================================================
```

------------------------------------------------------------------------------------------------------------------------

### 出金

資金の引き出しリクエストを送信します。 <br />
2022年4月1日より、トラベルルール対応として出金時に受取人の情報が必要となりました。（2022年10月27日より項目を追加）<br />
Zaifサイトから出金先のアドレスを登録し受取人情報を事前に登録すれば、APIからは今までどおりの出金を行うことができます。<br />
出金先アドレスに受取人情報が登録されていない場合、APIからの出金時に次の追加の情報を指定して出金することができます。

```eval_rst
+------------------------------------------------------------------------------+
| 項目名                                                                       |
+------------------------------------------------------------------------------+
|kind/vasp_master_id/vasp_name/beneficiary_corp_flg/other_vasp_name/           |
+------------------------------------------------------------------------------+
|beneficiary_name_last_name_kana/beneficiary_name_first_name_kana/             |
+------------------------------------------------------------------------------+
|beneficiary_name_last_name_en/beneficiary_name_first_name_en/                 |
+------------------------------------------------------------------------------+
|beneficiary_zip_code/beneficiary_country_id/beneficiary_area_jp/              |
+------------------------------------------------------------------------------+
|beneficiary_area_other/transfer_tx_purpose_id/transfer_tx_purpose_other_text/ |
+------------------------------------------------------------------------------+
|transfer_tx_purpose_item_text/transfer_tx_purpose_origin_text/                |
+------------------------------------------------------------------------------+
|transfer_tx_purpose_port_text/transfer_tx_purpose_destination_text/           |
+------------------------------------------------------------------------------+
|corp_type_id/corp_type_other_text/corp_identifier_type_position/              |
+------------------------------------------------------------------------------+
|corp_name_kana/corp_name_en                                                   |
+------------------------------------------------------------------------------+
```

2015年12月15日より、Zaif内の振替を除くリクエストには一旦トランザクションIDは空で返されるようになりました。 通常１～２分でトランザクションが発生しますので、後ほどwithdraw_historyメソッドを利用して確認してください xemの出金時には、手数料は自動計算され、opt_feeに値をセットして送信しますとエラーが返されますのでご注意ください。 不正送金の対策として、アカウントに対する最初の日本円入金から７日間は、APIによる仮想通貨の出金を制限しております。<br />
ZaifからのXEMの出金はmultisigトランザクションになります。<br />
multisigトランザクションに対応していない他の取引所やサービスへ送金されましても、Zaifでは対応致し兼ねますのでご注意ください。<br />

#### パラメータ
```eval_rst

========================================= ==== ==================================================================================================================================================================================== ============== ===========
パラメータ                                必須 詳細                                                                                                                                                                                 型             デフォルト
========================================= ==== ==================================================================================================================================================================================== ============== ===========
method                                    Yes   withdraw                                                                                                                                                                            str
currency                                  Yes   引き出す通貨。現物公開APIのcurrenciesで取得できるものが指定できます。ただしjpyは指定できません。                                                                                    str(例)btc等
address                                   Yes   送信先のアドレス                                                                                                                                                                    str
message                                   No    送信メッセージ(XEMのみ)                                                                                                                                                             ASCII　str
amount                                    Yes   出金額                                                                                                                                                                              numerical
opt_fee                                   No    採掘者への手数料。ただしcurrencyがbtc、mona以外の時に指定するとエラーとなります。                                                                                                   numerical
kind                                      No    (self：本人宛、other：それ以外)　左記文字列のみ使用可能                                                                                                                             str
beneficiary_corp_flg                      No   送金先の種別　(1：個人、2：法人)　左記のみ使用可能 kindでselfを指定した場合は不要、otherを指定した場合は必須                                                                         str
other_vasp_name                           No   送金先の名称　vasp_master_id　でvasp情報IDに「1：その他」指定した場合は必須 max：100文字まで                                                                                         str
beneficiary_name_last_name_kana           No   送金先氏名（カナ）姓　個人の場合必須　max：100文字まで                                                                                                                               str
beneficiary_name_first_name_kana          No   送金先氏名（カナ）名　個人の場合必須　max：100文字まで                                                                                                                               str
beneficiary_name_last_name_en             No   送金先氏名（英字）姓　個人の場合必須　半角英字（大文字）のみ使用可能 max：100文字まで                                                                                                str
beneficiary_name_first_name_en            No   送金先氏名（英字）名　個人の場合必須　半角英字（大文字）のみ使用可能 max：100文字まで                                                                                                str
beneficiary_zip_code                      Yes  送金先の郵便番号　max：100文字まで beneficiary_country_idで「JP」を指定した場合は半角数字のみ、「JP」以外を指定した場合は半角英数字（大文字）のみ使用可能                            str
beneficiary_country_id                    Yes  送金先の相手国　現物公開API　country_info　で取得したcodeを指定する。左記以外は不可                                                                                                  str
beneficiary_area_jp                       No   送金先の地域（日本）　beneficiary_country_idで「JP」を指定した場合は必須 max：100文字まで                                                                                            str
beneficiary_area_other                    No   送金先の地域（日本以外）beneficiary_country_idで「JP」以外を指定した場合は必須 max：300文字まで                                                                                      str
transfer_tx_purpose_id                    Yes  移転取引の目的 以下のみ指定可能（1：送付先VASPの提供する交換業に係るサービスの利用、2：国内の商品代金、3：相続、生活費の贈与、4：輸入代金の決済、5：仲介貿易代金の決済、99：その他） numerical
transfer_tx_purpose_other_text            No   移転取引の目的（具体的な内容）max：300文字まで 移転取引の目的で「99：その他」を指定した場合必須                                                                                      str
transfer_tx_purpose_item_text             No   移転取引の目的（商品の具体的な品目）max：300文字まで  移転取引の目的で「4：輸入代金の決済」もしくは「5：仲介貿易代金の決済」を指定した場合必須                                       str
transfer_tx_purpose_origin_text           No   移転取引の目的（原産地）max：300文字まで  移転取引の目的で「4：輸入代金の決済」もしくは「5：仲介貿易代金の決済」を指定した場合必須                                                   str
transfer_tx_purpose_port_text             No   移転取引の目的（船積地）max：300文字まで 移転取引の目的で「4：輸入代金の決済」もしくは「5：仲介貿易代金の決済」を指定した場合必須                                                    str
transfer_tx_purpose_destination_text      No   移転取引の目的（仕向地）max：300文字まで 移転取引の目的で「5：仲介貿易代金の決済」を指定した場合必須                                                                                 str
corp_type_id                              No   法人種別 現物公開API corp_type_id_info で取得したidを指定する。左記以外は不可                                                                                                        numerical
corp_type_other_text                      No   法人種別の名称 corp_type_id　で「1 ：その他」を指定した場合は入力必須 max：100文字まで                                                                                               str
corp_identifier_type_position             No   法人格の位置   （1： 前、 2：後）　左記のみ指定可能                                                                                                                                  numerical
corp_name_kana                            No   送金先名称（カナ）法人の場合必須　max：100文字まで 全角カナと全角スペースのみ使用可能                                                                                                str
corp_name_en                              No   送金先名称（アルファベット）法人の場合必須　max：100文字まで 半角の英字、.(ピリオド)、,(カンマ)、『 』(スペース)のみ使用可能                                                         str
vasp_master_id                            No   現物公開API vasp_info で取得したvasp_master_id　を指定する。左記以外は不可                                                                                                           str
vasp_name                                 No   vasp_master_id　が 1(その他）の場合のみ指定必須。max：100文字まで                                                                                                                    str
agreed                                    Yes  同意状態（True：同意、False：非同意）同意していただく内容については下記をご参照ください                                                                                              bool
========================================= ==== ==================================================================================================================================================================================== ============== ===========
```


#### 戻り値
```eval_rst
===== ============================== ===
キー  詳細                           型
===== ============================== ===
id    出金ID                         int
txid  振替ID                         str
fee   今回の引き出しにかかった手数料 float
funds 残高                           dict
===== ============================== ===
```

```
{
  "success": 1,
  "return": {
      "id": 23634,
      "fee": 0.001,
      "txid":,
      "funds": {
          "jpy": 15320,
          "btc": 1.392,
          "xem": 100.2,
          "mona": 2600
      }
}
```

#### エラーメッセージ
```eval_rst
============================================================================= ===================================================================
メッセージ                                                                     詳細
============================================================================= ===================================================================
kyc is not finished                                                           郵送による本人確認が完了していません。
insufficient funds                                                            取引に必要な残高が存在しません。
please specify kind                                                           宛先を設定してください
invalid kind                                                                  宛先の形式が正しくありません
please specify beneficiary_corp_flg                                           送金先の種別を指定してください
invalid beneficiary_corp_flg                                                  送金先の種別の形式が正しくありません
please specify vasp_name                                                      送金先「その他」を具体的に入力してください
invalid vasp_name length                                                      送金先「その他」の長さが正しくありません
invalid vasp_name format                                                      送金先「その他」の形式が正しくありません
please specify beneficiary_name_last_name_kana                                送金先氏名（カナ）（姓）を指定してください
invalid beneficiary_name_last_name_kana length                                送金先氏名（カナ）（姓）の長さが正しくありません
invalid beneficiary_name_last_name_kana format                                送金先氏名（カナ）（姓）の形式が正しくありません
please set beneficiary_name_last_name_kana in the withdrawal address setting  送金先氏名（カナ）（姓）を出金先アドレス管理で設定してください
please specify beneficiary_name_first_name_kana                               送金先氏名（カナ）（名）を指定してください
invalid beneficiary_name_first_name_kana length                               送金先氏名（カナ）（名）の長さが正しくありません
invalid beneficiary_name_first_name_kana format                               送金先氏名（カナ）（名）の形式が正しくありません
please set beneficiary_name_first_name_kana in the withdrawal address setting 送金先氏名（カナ）（名）を出金先アドレス管理で設定してください
please specify beneficiary_name_last_name_en                                  送金先氏名（アルファベット）（姓）を指定してください
invalid beneficiary_name_last_name_en length                                  送金先氏名（アルファベット）（姓）の長さが正しくありません
invalid beneficiary_name_last_name_en format                                  送金先氏名（アルファベット）（姓）の形式が正しくありません
please set beneficiary_name_last_name_en in the withdrawal address setting    送金先氏名（アルファベット）（姓）を出金先アドレス管理で設定してください
please specify beneficiary_name_first_name_en                                 送金先氏名（アルファベット）（名）を指定してください
invalid beneficiary_name_first_name_en length                                 送金先氏名（アルファベット）（名）の長さが正しくありません
invalid beneficiary_name_first_name_en format                                 送金先氏名（アルファベット）（名）の形式が正しくありません
please set beneficiary_name_first_name_en in the withdrawal address setting   送金先氏名（アルファベット）（名）を出金先アドレス管理で設定してください
please specify corp_type_id                                                   法人種別を指定してください
invalid corp_type_id format                                                   法人種別の形式が正しくありません
please set corp_type_id in the withdrawal address setting                     法人種別を出金先アドレス管理で設定してください
please specify corp_type_other_text                                           法人種別の具体的な名称を指定してください
invalid corp_type_other_text length                                           法人種別の具体的な名称の長さが正しくありません
invalid corp_type_other_text format                                           法人種別の具体的な名称の形式が正しくありません
please set corp_type_other_text in the withdrawal address setting             法人種別の具体的な名称を出金先アドレス管理で設定してください
please specify corp_identifier_type_position                                  法人格（位置）を指定してください
invalid corp_identifier_type_position format                                  法人格（位置）の形式が正しくありません
please set corp_identifier_type_position in the withdrawal address setting    法人格（位置）を出金先アドレス管理で設定してください
please specify corp_name_kana                                                 送金先名称（カナ）を指定してください
invalid corp_name_kana length                                                 送金先名称（カナ）の長さが正しくありません
invalid corp_name_kana format                                                 送金先名称（カナ）の形式が正しくありません
please set corp_name_kana in the withdrawal address setting                   送金先名称（カナ）を出金先アドレス管理で設定してください
please specify corp_name_en                                                   送金先名称（アルファベット）を指定してください
invalid corp_name_en length                                                   送金先名称（アルファベット）の長さが正しくありません
invalid corp_name_en format                                                   送金先名称（アルファベット）の形式が正しくありません
please set corp_name_en in the withdrawal address setting                     送金先名称（アルファベット）を出金先アドレス管理で設定してください
please specify beneficiary_zip_code                                           送金先の郵便番号を指定してください
invalid beneficiary_zip_code length                                           送金先の郵便番号の長さが正しくありません
invalid beneficiary_zip_code format                                           送金先の郵便番号の形式が正しくありません
please set beneficiary_zip_code in the withdrawal address setting             送金先の郵便番号を出金先アドレス管理で設定してください
please specify beneficiary_country_id                                         送金先（相手国）を指定してください
invalid beneficiary_country_id format                                         送金先（相手国）の形式が正しくありません
please set beneficiary_country_id in the withdrawal address setting           送金先（相手国）を出金先アドレス管理で設定してください
please specify beneficiary_area_jp                                            送金先の地域（日本）を指定してください
invalid beneficiary_area_jp length                                            送金先の地域（日本）の長さが正しくありません
please set beneficiary_area_jp in the withdrawal address setting              送金先の地域（日本）を出金先アドレス管理で設定してください
please specify beneficiary_area_other                                         送金先の地域（日本以外）を指定してください
invalid beneficiary_area_other length                                         送金先の地域（日本以外）の長さが正しくありません
please set beneficiary_area_other in the withdrawal address setting           送金先の地域（日本以外）を出金先アドレス管理で設定してください
please specify transfer_tx_purpose_id                                         移転取引の目的を指定してください
invalid transfer_tx_purpose_id format                                         移転取引の目的の形式が正しくありません
please specify transfer_tx_purpose_other_text                                 移転取引の目的について具体的な内容を指定してください
invalid transfer_tx_purpose_other_text length                                 移転取引の目的の具体的な内容の長さが正しくありません
please specify transfer_tx_purpose_item_text                                  移転取引の目的（商品の具体的な品目）について具体的な内容を指定してください
invalid transfer_tx_purpose_item_text length                                  移転取引の目的（商品の具体的な品目）の具体的な内容の長さが正しくありません
please specify transfer_tx_purpose_origin_text                                移転取引の目的（原産地）について具体的な内容を指定してください
invalid transfer_tx_purpose_origin_text length                                移転取引の目的（原産地）の具体的な内容の長さが正しくありません
please specify transfer_tx_purpose_port_text                                  移転取引の目的（船積地）について具体的な内容を指定してください
invalid transfer_tx_purpose_port_text length                                  移転取引の目的（船積地）の具体的な内容の長さが正しくありません
please specify transfer_tx_purpose_destination_text                           移転取引の目的（仕向地）について具体的な内容を指定してください
invalid transfer_tx_purpose_destination_text length                           移転取引の目的（仕向地）の具体的な内容の長さが正しくありません
please specify vasp_master_id                                                 VASP情報IDを設定してください
invalid vasp_master_id                                                        VASP情報IDが正しくありません
please specify vasp_name                                                      送金先を設定してください
invalid vasp_name length                                                      送金先の長さが正しくありません
invalid vasp_name format                                                      送金先の形式が正しくありません
invalid agreed parameter                                                      同意状態の形式が正しくありません
invalid agreement state                                                       同意状態を同意（True）で設定してください
============================================================================= ===================================================================
```


``` note::
    * パラメータ“kind“、“vasp_master_id“、“vasp_name“、“beneficiary_corp_flg“、  “other_vasp_name“、“beneficiary_name_last_name_kana“、  “beneficiary_name_first_name_kana“、“beneficiary_name_last_name_en“、  “beneficiary_name_first_name_en“、“beneficiary_zip_code“、“beneficiary_country_id“、  “beneficiary_area_jp“、“beneficiary_area_other“、“transfer_tx_purpose_id“、  “transfer_tx_purpose_other_text“、“transfer_tx_purpose_item_text“、  “transfer_tx_purpose_origin_text“、“transfer_tx_purpose_port_text“、  “transfer_tx_purpose_destination_text“、“corp_type_id“、“corp_type_other_text“、  “corp_identifier_type_position“、“corp_name_kana“、“corp_name_en“は、    addressに指定したアドレスが出金先アドレス管理にて設定済みで、かつ上記の項目が設定されている場合、それらの値が適用されます。    （この場合、当該リクエストで上記項目が設定されても無視されます）    もしくは“address“に指定したアドレスが出金先アドレス管理にて設定済みで、かつ上記の項目が設定されていない場合は    当該リクエストで上記項目を必ず設定する必要があります。
    * 受取人を本人宛（パラメータ“kind“=“self“）とする場合、パラメータ“beneficiary_name_last_name_kana“、 “beneficiary_name_first_name_kana“、“beneficiary_name_last_name_en“、 “beneficiary_name_first_name_en“、“beneficiary_zip_code“、“beneficiary_country_id“、 “beneficiary_area_jp“、“beneficiary_area_other“、“corp_type_id“、“corp_type_other_text“、 “corp_identifier_type_position“、“corp_name_kana“、“corp_name_en“は、 予め出金先アドレス管理にて設定しておく必要があります。この場合、上記の項目は当該リクエストで設定されても無視されます。
    * “kind“、“vasp_name“、“vasp_timestamp“及びそれらに関連するエラーメッセージは2022年4月1日より適用となります。
    * “beneficiary_name“は2022年10月27日より未使用項目となります。
    * “beneficiary_corp_flg“、“other_vasp_name“、“beneficiary_name_last_name_kana“、  “beneficiary_name_first_name_kana“、“beneficiary_name_last_name_en“、  “beneficiary_name_first_name_en“、“beneficiary_zip_code“、“beneficiary_country_id“、  “beneficiary_area_jp“、“beneficiary_area_other“、“transfer_tx_purpose_id“、  “transfer_tx_purpose_other_text“、“transfer_tx_purpose_item_text“、  “transfer_tx_purpose_origin_text“、“transfer_tx_purpose_port_text“、  “transfer_tx_purpose_destination_text“、“corp_type_id“、“corp_type_other_text“、  “corp_identifier_type_position“、“corp_name_kana“、“corp_name_en“、“agreed“  及びそれらに関連するエラーメッセージは2022年10月27日より取得可能となります。
```

※「agreed」パラメータにtrueを指定して行われた全ての送金について、以下内容に同意したものとみなします。
* 弊社の[利用規約](https://zaif.jp/terms)を遵守します。
* イラン・北朝鮮・ミャンマーへの送金ではありません。
* 法令等（外為法・米国OFAC等）の規制に抵触いたしません。
* 送金先及び送金先の実質的支配者が規制対象者ではありません。


------------------------------------------------------------------------------------------------------------------------

### 入金履歴の取得

入金履歴を取得します。

#### パラメータ
```eval_rst
========== ==== ============================ ================= ==========
パラメータ 必須 詳細                         型                デフォルト
========== ==== ============================ ================= ==========
method     Yes  deposit_history              str
currency   Yes  通貨                         str(例)jpy 等     指定なし
from       No   この順番のレコードから取得   int               0
count      No   取得するレコード数           int               1000
from_id    No   この入金IDのレコードから取得 int               0
end_id     No   この入金IDのレコードまで取得 int               infinity
order      No   ソート順                     str (ASC or DESC) DESC
since      No   開始タイムスタンプ           UNIX_TIMESTAMP    0
end        No   終了タイムスタンプ           UNIX_TIMESTAMP    infinity
========== ==== ============================ ================= ==========
```

#### 戻り値
```eval_rst
========= ================== =============
キー      詳細               型
========= ================== =============
timestamp 出金日時           UNIX_TIMESTAMP
address   出金先アドレス     str
amount    取引量             float
txid      トランザクションID str
========= ================== =============
```

```
{
    "success":1,
    "return":{
        "3816":{
          "timestamp":1435745065,
          "address":"12qwQ3sPJJAosodSUhSpMds4WfUPBeFEM2",
          "amount":0.001,
          "txid":"64dcf59523379ba282ae8cd61d2e9382c7849afe3a3802c0abb08a60067a159f",
        },
        "3814":{
          "timestamp":1435548083,
          "address":"12qwQ3sPJJAosodSUhSpMds4WfUPBeFEM2",
          "amount":0.001,
          "txid":"7d012cfff6e67a8938f93215367eef4177604459631ea62c85550980dca71819"
        },
    }
}
```

#### 補足
* 呼び出しは60秒間に10回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

* “since”もしくは”end”をセットした場合、”order”は強制的に”ASC”となります。

* “from_id”もしくは”end_id”をセットした場合、”order”は強制的に”ASC”となります。


------------------------------------------------------------------------------------------------------------------------

### 出金履歴の取得

出金履歴を取得します。

#### パラメータ
```eval_rst
========== ==== ============================ ================= ===========
パラメータ 必須 詳細                         型                デフォルト
========== ==== ============================ ================= ===========
method     Yes  withdraw_history             str
currency   Yes  通貨                         str(例)jpy 等     指定なし
from       No   この順番のレコードから取得   int               0
count      No   取得するレコード数           int               1000
from_id    No   この出金IDのレコードから取得 int               0
end_id     No   この出金IDのレコードまで取得 int               infinity
order      No   ソート順                     str (ASC or DESC) DESC
since      No   開始タイムスタンプ           UNIX_TIMESTAMP    0
end        No   終了タイムスタンプ           UNIX_TIMESTAMP    infinity
========== ==== ============================ ================= ===========
```

#### 戻り値
```eval_rst
===================================== ======================================== ==============
キー                                  詳細                                     型
===================================== ======================================== ==============
timestamp                             出金日時                                 UNIX_TIMESTAMP
address                               出金先アドレス                           str
amount                                取引量                                   float
txid                                  トランザクションID                       str
kind                                  宛先                                     str
beneficiary_corp_flg                  送金先の種別 (個人/法人)                 str
other_vasp_name                       送金先の名称                             str
beneficiary_name                      送金先氏名（カナ）（個人のみ）           str
beneficiary_name_en                   送金先氏名（英字）（個人のみ）           str
beneficiary_zip_code                  送金先の郵便番号                         str
beneficiary_country                   送金先の相手国                           str
beneficiary_area                      送金先の地域                             str
transfer_tx_purpose                   移転取引の目的                           str
transfer_tx_purpose_other_text        移転取引の目的（具体的な内容）           str
transfer_tx_purpose_item_text         移転取引の目的（商品の具体的な品目）     str
transfer_tx_purpose_origin_text       移転取引の目的（原産地）                 str
transfer_tx_purpose_port_text         移転取引の目的（船積地）                 str
transfer_tx_purpose_destination_text  移転取引の目的（仕向地）                 str
corp_type                             法人種別名称 （法人のみ）                str
corp_type_other_text                  法人種別その他名称（法人のみ）           str
corp_identifier_type_position         法人格の位置（法人のみ）（前/後）        str
corp_name_kana                        送金先名称（カナ）（法人のみ）           str
corp_name_en                          送金先名称（アルファベット）（法人のみ） str
vasp_master_id                        VASP情報ID                               str
vasp_name                             送金先                                   str
vasp_timestamp                        VASP情報登録日時                         UNIX_TIMESTAMP
agreed                                同意状態                                 str
===================================== ======================================== ==============
```

```
{
    "success":1,
    "return":{
        "3816":{
          "timestamp":1435745065,
          "address":"12qwQ3sPJJAosodSUhSpMds4WfUPBeFEM2",
          "amount":0.001,
          "txid":"64dcf59523379ba282ae8cd61d2e9382c7849afe3a3802c0abb08a60067a159f",
          "kind": "本人宛",
          "beneficiary_corp_flg": "個人",
          "beneficiary_name": "ザイフ タロウ",
          "beneficiary_name_en": "TARO ZAIF",
          "beneficiary_zip_code": "0000001",
          "beneficiary_country": "JP",
          "beneficiary_area": "北海道",
          "transfer_tx_purpose": "輸入代金の決済",
          "transfer_tx_purpose_item_text": "かばん",
          "transfer_tx_purpose_origin_text": "アメリカ",
          "transfer_tx_purpose_port_text": "CA",
          "vasp_name": "タロウ証券",
          "vasp_timestamp": "1435745065",
          "agreed": "同意済",
        },
        "3814":{
          "timestamp":1435548083,
          "address":"12qwQ3sPJJAosodSUhSpMds4WfUPBeFEM2",
          "amount":0.001,
          "txid":"7d012cfff6e67a8938f93215367eef4177604459631ea62c85550980dca71819",
          "kind": "それ以外",
          "beneficiary_corp_flg": "法人",
          "corp_name_kana": "ザイフ",
          "corp_name_en": "ZAIF",
          "beneficiary_zip_code": "0000001",
          "beneficiary_country": "JP",
          "beneficiary_area": "北海道",
          "transfer_tx_purpose": "その他",
          "transfer_tx_purpose_other_text": "財産譲渡のため",
          "corp_type": "有限会社",
          "corp_identifier_type_position": "前",
          "vasp_name": "Coinhanako",
          "vasp_timestamp": "1435548083",
          "agreed": "同意済",
        },
    }
}
```

#### 補足
* 呼び出しは60秒間に10回以下におさまるようにしてください。呼び出しが多すぎるとアクセス拒否されることがあります。[（※）](<trading_notice_1>)

* “since”もしくは”end”をセットした場合、”order”は強制的に”ASC”となります。

* “from_id”もしくは”end_id”をセットした場合、”order”は強制的に”ASC”となります。


``` note::
    * “kind“、“vasp_name“、“vasp_timestamp“は2022年4月1日より取得可能となります。
    * “beneficiary_corp_flg“、“other_vasp_name“、“beneficiary_name“、  “beneficiary_name_en“、  “beneficiary_zip_code“、“beneficiary_country“、  “beneficiary_area“、“transfer_tx_purpose“、  “transfer_tx_purpose_other_text“、“transfer_tx_purpose_item_text“、  “transfer_tx_purpose_origin_text“、“transfer_tx_purpose_port_text“、  “transfer_tx_purpose_destination_text“、“corp_type“、“corp_type_other_text“、  “corp_identifier_type_position“、“corp_name_kana“、“corp_name_en“、“agreed“  は2022年10月27日より取得可能となります。
```
